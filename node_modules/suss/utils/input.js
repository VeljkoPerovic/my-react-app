/**
 * Created by franco on 12/09/2016.
 * Input para console
 */

var promptSync = require('prompt-sync');

// --------------------------------------------------
// CONFIGURATIONS
// --------------------------------------------------

var prompt = promptSync({});

// --------------------------------------------------
// METHODS
// --------------------------------------------------

/**
 * Recupera um valor do console ou um valor default
 * @param message
 * @param defaultValue
 */
function valueOrDefault(message, defaultValue) {
    if (!message.match(/^.* $/)) message += ' ';
    var input = value(message + '(' + defaultValue + ') ') || defaultValue;
    return input;
}

/**
 * Recupera um valor do console
 * @param message
 * @returns {*}
 */
function value(message) {
    if (!message.match(/^.* $/)) message += ' ';
    return checkExitCommand(prompt(message));
}

/**
 * Verificação de comando EXIT (CTRL+C)
 * @param input
 * @returns {*}
 */
function checkExitCommand(input) {
    if (input === null) {
        throw (new Error('Exit Command'));
    }
    return input;
}

/**
 * Mensagem de confirmação
 * @param message
 * @returns {Array|{index: number, input: string}}
 */
function confirm(message) {
    return String(prompt(message)).match(/^y|yes|ok|true&/i);
}

// --------------------------------------------------
// EXPORTS
// --------------------------------------------------

module.exports.valueOrDefault = valueOrDefault;
module.exports.value = value;
module.exports.confirm = confirm;
